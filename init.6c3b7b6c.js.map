{"version":3,"sources":["js/dictionary.js","js/ui.js","js/actions.js","js/keyboard.js","js/board.js","js/utils.js","js/piece.js","js/levels.js","js/level.js","js/ai.js","js/gameState.js","js/init.js"],"names":["MESSAGE_DOOR_LOCKED","MESSAGE_KEY_PICK_UP","MESSAGE_PIECE_FELL","MESSAGE_HUMAN_TAKEN","MESSAGE_HUMAN_CHECK","MESSAGE_SWORD_PICK_UP","MESSAGE_SHIELD_PICK_UP","MESSAGE_KILLED_AI_SWORD","MESSAGE_SHOVED_AI_SHIELD","MESSAGE_SQUASHED_AI_SHIELD","BOARD_CSS_CLASS_NAME","BOARD_WIDTH_CSS_CLASS_NAME","PIECE_CSS_CLASS_FOR_JS_BASE","PIECE_CSS_CLASS_FOR_JS","PIECE_MOVE_ANIMATION_TIME_MS","BOARD_SQUARE_CSS_CLASS_NAME","CSS_CLASS_NAME_FOR_ACTION","CSS_CLASS_NAME_MESSAGE","CSS_CLASS_NAME_DIRECTION","CSS_CLASS_NAME_BOARD_INNER","addActionToUi","action","boardSquareCssClassName","boardPosition","type","iconSpecific","document","querySelector","classList","add","addPieceToBoardUi","piece","boardSizeX","boardSizeY","boardCssClassName","pieceDOMElement","createElement","className","generatePieceClassName","append","movePiece","playerId","clearActionUi","actionClassName","remove","clearLevelUi","removePiecesFromBoard","removeActionsFromBoard","clearMessageUi","innerHTML","clearTargetBoardPositionsUi","querySelectorAll","forEach","node","setBoardWidthCssClassName","boardContainerEl","classNameToAdd","classNameToRemove","newClassListArray","filter","includes","push","join","createBoardUi","boardContainerClassName","boardContainerInnerEl","square","row","boardRow","column","boardSquare","el","elClassList","directions","direction","value","name","getPieceCssClassName","pieceId","handleLoweringPiecesUi","aiPieces","boardPositionsRaised","humanPieces","pos","lowerBoardPositionUi","humanPiece","lowerPieceUi","aiPiece","handleRaisingPiecesUi","raisePieceUi","initActionsUi","actions","initAiPiecesUi","initBoardPositionsMissingUi","boardPositionsMissing","setBoardPositionMissingUi","initBoardPositionsRaisedUi","raiseBoardPositionUi","initHumanPiecesUi","human","updatePlayerLivesUi","lives","initLevelNumberUi","levelNumber","numberOfLevels","getElementById","innerText","initSettingsUi","goToLevelCallback","getElementsByClassName","addEventListener","e","preventDefault","squareToMoveTo","numberOfSquaresWide","numberOfSquaresHigh","colNumber","rowNumber","Math","ceil","style","top","left","playHitAnimationUi","element","setTimeout","ACTION_EXIT","removePieceFromBoardUi","setTargetBoardPositionsUi","boardPositions","position","setPieceDidFallUi","showMessageUi","message","updatePieceDirectionUi","cssClassName","numberOfLives","playerLivesDomContainer","togglePieceWeaponUi","weaponType","pieceDom","toggle","ACTION_EXIT_CLOSED","ACTION_KEY","ACTION_LEVER_OFF","ACTION_LEVER_ON","ACTION_STAIRS","ACTION_SWORD","ACTION_SHIELD","ACTIONS_ALLOWED_FOR_AI","handleActionKey","indexOfAction","levelActions","newLevelActions","JSON","parse","stringify","splice","actionExitClosedIndex","findIndex","actionExitOpenIndex","handleExitClosed","handleActionLeverOff","indexOfLeverOff","indexOfLeverOn","handleActionLeverOn","handleActionSword","handleActionShield","KEYCODE_UP","KEYCODE_DOWN","KEYCODE_LEFT","KEYCODE_RIGHT","KEYCODE_UP_LEFT","KEYCODE_UP_RIGHT","KEYCODE_DOWN_LEFT","KEYCODE_DOWN_RIGHT","KEYCODE_RESTART","KEYCODE_ENTER","ALL_DIRECTIONS","initUserControls","handleUserInputMove","showNextMessage","restartLevel","window","code","canMoveLeft","currentBoardPosition","canMoveRight","canMoveUp","canMoveDown","getNextBoardPositionWithDirection","getAllBoardCheckPositions","boardPositionsOccupied","currentBoardPositionsRaised","showTargetLines","allTargetBoardPositions","isPieceRaised","getIsPieceRaised","pieceTargetBoardPositions","getTargetLines","concat","getNextBoardPosition","boardPositionsUnavailable","moveToSquare","isBoardPositionUnavailable","getBoardPositionsUnavailable","Set","getBoardPositionsAPieceCantBeShovedOnto","positionsOccupiedAi","map","positionsOccupiedHumans","getBoardPositionsOccupied","getRandomBoardPosition","random","directionTargets","getTargetsWithDirection","targets","loopCounter","getNextTarget","nextTargetSquare","handleShovePiece","directionOfShove","positionToShoveTo","pieceDomClassName","length","capitalize","string","charAt","toUpperCase","slice","Piece","getRandomDirection","floor","Queen","constructor","King","Rook","Bishop","getOppositeDirection","togglePieceWeapon","hasWeapon","levels","boardSize","levelMessages","loadLevel","clearLevel","showLevelMessage","messageIndex","getNumberOfLevels","moveAi","pieceDomClass","getAiWithDirectionsForNextMove","nextMoves","nextMove","nextMoveOpposite","console","log","gameState","levelState","nextLevelNumber","init","bind","handleGoToLevel","initLevel","alert","levelOver","initLevelMessages","endMove","beforeMove","isMoving","checkActionsInterceptHuman","indexOfLevelStateAction","doBoardAction","checkActionsInterceptAi","checkHumanInCheck","allCheckBoardPositions","checkTargetLinesIntercept","checkHumanInterceptsAi","ai","humanThatWasInterceptedIndex","humanThatWasIntercepted","hasSword","hasShield","unavailablePositions","lastUserInput","checkMissingBoardPositionForHuman","checkMissingBoardPositionsForAi","updateBoardPositionsUnavailable","updateBoardPositionsOccupied","updateAiDirections","handleMove","keyCode","levelIndex","nextLevelIndex","updatePlayerLives","increment","onload"],"mappings":"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","file":"init.6c3b7b6c.js","sourceRoot":"../checkmaze-browser/src","sourcesContent":["export const MESSAGE_DOOR_LOCKED =\n  \"Ugh, it's locked! I'll need to find a key, or something to pick the lock...\";\nexport const MESSAGE_KEY_PICK_UP = \"A key! I'd best pocket this...\";\nexport const MESSAGE_PIECE_FELL = \"Arghhhhh!... [PRESS R to RESTART]\";\nexport const MESSAGE_HUMAN_TAKEN =\n  \"No! Captured! Don't take me back to that cell!... [PRESS R to RESTART]\";\nexport const MESSAGE_HUMAN_CHECK =\n  \"No! They've seen me! I've been caught!... [PRESS R to RESTART]\";\nexport const MESSAGE_SWORD_PICK_UP =\n  \"A sword! This will give me a fighting chance!\";\nexport const MESSAGE_SHIELD_PICK_UP = \"A shield! This might help protect me!\";\nexport const MESSAGE_KILLED_AI_SWORD =\n  \"Ahah! Slain with the sword! That's one less guard to worry about...\";\nexport const MESSAGE_SHOVED_AI_SHIELD =\n  \"OOSH! Shoved into the abyss with the mighty shield!\";\nexport const MESSAGE_SQUASHED_AI_SHIELD =\n  \"Bash! I squashed them against the wall with the mighty shield!\";\n","import { ACTION_EXIT } from \"./actions\";\n\nexport const BOARD_CSS_CLASS_NAME = \"js-castle\";\nexport const BOARD_WIDTH_CSS_CLASS_NAME = \"cm-board-width-\";\nexport const PIECE_CSS_CLASS_FOR_JS_BASE = \"js-piece\";\nexport const PIECE_CSS_CLASS_FOR_JS = \"js-piece--\";\nexport const PIECE_MOVE_ANIMATION_TIME_MS = 300;\nexport const BOARD_SQUARE_CSS_CLASS_NAME = \"js-cm-board__square--\";\nconst CSS_CLASS_NAME_FOR_ACTION = \"js-action\";\nconst CSS_CLASS_NAME_MESSAGE = \"js-message\";\nconst CSS_CLASS_NAME_DIRECTION = \"cm-piece-direction--\";\nconst CSS_CLASS_NAME_BOARD_INNER = \"js-cm-board__inner\";\n\nexport function addActionToUi(\n  action,\n  boardSquareCssClassName = BOARD_SQUARE_CSS_CLASS_NAME\n) {\n  let { boardPosition, type } = action;\n  if (action.iconSpecific) {\n    type = action.iconSpecific;\n  }\n  document\n    .querySelector(`.${boardSquareCssClassName}${boardPosition}`)\n    .classList.add(`cm-action`, `js-action`, `cm-action--${type}`);\n}\n\nexport function addPieceToBoardUi(\n  piece,\n  boardSizeX,\n  boardSizeY,\n  boardCssClassName = BOARD_CSS_CLASS_NAME\n) {\n  const pieceDOMElement = document.createElement(`div`);\n\n  pieceDOMElement.className = generatePieceClassName(piece, boardCssClassName);\n  document.querySelector(`.${boardCssClassName}`).append(pieceDOMElement);\n  movePiece(\n    `${boardCssClassName} .js-piece--${piece.playerId}`,\n    piece.boardPosition,\n    boardSizeX,\n    boardSizeY\n  );\n}\n\nexport function clearActionUi(actionClassName, boardPosition) {\n  document\n    .querySelector(`.${BOARD_SQUARE_CSS_CLASS_NAME}${boardPosition}`)\n    .classList.remove(\n      `cm-action`,\n      `js-action`,\n      `cm-action--${actionClassName}`\n    );\n}\n\nexport function clearLevelUi() {\n  removePiecesFromBoard();\n  removeActionsFromBoard();\n}\n\nexport function clearMessageUi() {\n  document.querySelector(`.${CSS_CLASS_NAME_MESSAGE}`).innerHTML = \"\";\n}\n\nexport function clearTargetBoardPositionsUi() {\n  document.querySelectorAll(\".is-target\").forEach((node) => {\n    node.classList.remove(\"is-target\");\n  });\n}\n\nfunction setBoardWidthCssClassName(boardContainerEl, boardSizeX) {\n  const classNameToAdd = `${BOARD_WIDTH_CSS_CLASS_NAME}${boardSizeX}`;\n  const classNameToRemove = `${BOARD_WIDTH_CSS_CLASS_NAME}`;\n  // filter out the class name to be removed\n  const newClassListArray = [...boardContainerEl.classList].filter(\n    (className) => {\n      return !className.includes(classNameToRemove);\n    }\n  );\n  newClassListArray.push(classNameToAdd);\n  boardContainerEl.classList = newClassListArray.join(\" \");\n}\n\nexport function createBoardUi({\n  boardSizeX,\n  boardSizeY,\n  boardContainerClassName = BOARD_CSS_CLASS_NAME,\n}) {\n  const boardContainerEl = document.querySelector(\n    `.${boardContainerClassName}`\n  );\n  const boardContainerInnerEl = document.querySelector(\n    `.${boardContainerClassName} .${CSS_CLASS_NAME_BOARD_INNER}`\n  );\n  if (boardContainerEl && boardContainerInnerEl) {\n    setBoardWidthCssClassName(boardContainerEl, boardSizeX);\n    boardContainerInnerEl.innerHTML = \"\";\n\n    let square = 1;\n    for (let row = 1; row <= boardSizeY; row++) {\n      // create rows\n      const boardRow = document.createElement(`div`);\n      boardRow.className = `cm-board__row`;\n      for (let column = 1; column <= boardSizeX; column++) {\n        // create squares\n        const boardSquare = document.createElement(`div`);\n        boardSquare.className = `cm-board__square js-cm-board__square--${square}`;\n        square++;\n        boardRow.append(boardSquare);\n      }\n      boardContainerInnerEl.append(boardRow);\n    }\n  }\n}\n\nexport function generatePieceClassName(\n  piece,\n  boardCssClassName = BOARD_CSS_CLASS_NAME\n) {\n  const el = document.querySelector(\n    `.${boardCssClassName} .${PIECE_CSS_CLASS_FOR_JS}${piece.playerId}`\n  );\n\n  if (el) {\n    let elClassList = [...el.classList];\n    piece.type.directions.forEach((direction) => {\n      elClassList = elClassList.filter((value) => {\n        // remove prev direction\n        return value !== `${CSS_CLASS_NAME_DIRECTION}${direction}`;\n      });\n    });\n\n    // add new direction\n    if (piece.direction) {\n      elClassList.push(`cm-piece-direction--${piece.direction}`);\n    }\n\n    return elClassList.join(\" \");\n  } else {\n    // new piece\n    return `cm-piece cm-piece--${\n      piece.type.name\n    } ${PIECE_CSS_CLASS_FOR_JS_BASE} ${\n      piece.direction\n        ? `cm-piece-direction cm-piece-direction--${piece.direction}`\n        : \"\"\n    } ${PIECE_CSS_CLASS_FOR_JS}${piece.playerId}`;\n  }\n}\n\nexport function getPieceCssClassName(pieceId) {\n  return `${PIECE_CSS_CLASS_FOR_JS}${pieceId}`;\n}\n\nexport function handleLoweringPiecesUi({\n  aiPieces,\n  boardPositionsRaised,\n  humanPieces,\n}) {\n  boardPositionsRaised.forEach((pos) => {\n    lowerBoardPositionUi(pos);\n    humanPieces.forEach((humanPiece) => {\n      if (humanPiece.boardPosition === pos) {\n        lowerPieceUi(humanPiece.playerId);\n      }\n    });\n    aiPieces.forEach((aiPiece) => {\n      if (aiPiece.boardPosition === pos) {\n        lowerPieceUi(aiPiece.playerId);\n      }\n    });\n  });\n  return []; // boardPositionsRaised becomes empty\n}\n\nexport function handleRaisingPiecesUi({\n  aiPieces,\n  boardPositionsRaised,\n  humanPieces,\n}) {\n  boardPositionsRaised.forEach((pos) => {\n    humanPieces.forEach((humanPiece) => {\n      if (humanPiece.boardPosition === pos) {\n        raisePieceUi(humanPiece.playerId);\n      }\n    });\n    aiPieces.forEach((aiPiece) => {\n      if (aiPiece.boardPosition === pos) {\n        raisePieceUi(aiPiece.playerId);\n      }\n    });\n  });\n\n  return boardPositionsRaised;\n}\n\nexport function initActionsUi(actions, boardSquareCssClassName) {\n  actions.forEach((action) => {\n    addActionToUi(action, boardSquareCssClassName);\n  });\n}\n\nexport function initAiPiecesUi(\n  aiPieces,\n  boardSizeX,\n  boardSizeY,\n  boardCssClassName\n) {\n  if (aiPieces && boardSizeX && boardSizeY) {\n    aiPieces.forEach((aiPiece) => {\n      addPieceToBoardUi(aiPiece, boardSizeX, boardSizeY, boardCssClassName);\n    });\n  }\n}\n\nexport function initBoardPositionsMissingUi(\n  boardPositionsMissing,\n  boardSquareCssClassName\n) {\n  if (boardPositionsMissing) {\n    boardPositionsMissing.forEach((boardPosition) => {\n      setBoardPositionMissingUi(boardPosition, boardSquareCssClassName);\n    });\n  }\n}\n\nexport function initBoardPositionsRaisedUi(\n  boardPositionsRaised,\n  boardSquareCssClassName\n) {\n  if (boardPositionsRaised) {\n    boardPositionsRaised.forEach((boardPosition) => {\n      raiseBoardPositionUi(boardPosition, boardSquareCssClassName);\n    });\n  }\n}\n\nexport function initHumanPiecesUi(\n  humanPieces,\n  boardSizeX,\n  boardSizeY,\n  boardCssClassName\n) {\n  humanPieces.forEach((human) => {\n    addPieceToBoardUi(human, boardSizeX, boardSizeY, boardCssClassName);\n    updatePlayerLivesUi(human.lives);\n  });\n}\n\nexport function initLevelNumberUi(levelNumber, numberOfLevels) {\n  document.getElementById(\n    \"level-title\"\n  ).innerText = `Level ${levelNumber} of ${numberOfLevels}`;\n}\n\nexport function initSettingsUi(goToLevelCallback) {\n  document\n    .getElementsByClassName(\"js-link--next-level\")[0]\n    .addEventListener(\"click\", function (e) {\n      e.preventDefault();\n      goToLevelCallback();\n    });\n  document\n    .getElementsByClassName(\"js-link--previous-level\")[0]\n    .addEventListener(\"click\", function (e) {\n      e.preventDefault();\n      goToLevelCallback(-1);\n    });\n}\n\nexport function lowerBoardPositionUi(boardPosition) {\n  document\n    .querySelector(`.${BOARD_SQUARE_CSS_CLASS_NAME}${boardPosition}`)\n    .classList.remove(\"is-raised\");\n}\n\nexport function lowerPieceUi(playerId) {\n  document\n    .querySelector(`.${PIECE_CSS_CLASS_FOR_JS}${playerId}`)\n    .classList.remove(\"is-raised\");\n}\n\nexport function movePiece(\n  pieceDOMElement,\n  squareToMoveTo,\n  boardSizeX,\n  boardSizeY\n) {\n  const numberOfSquaresWide = boardSizeX;\n  const numberOfSquaresHigh = boardSizeY;\n  let colNumber = squareToMoveTo % numberOfSquaresWide;\n\n  if (colNumber === 0) {\n    colNumber = numberOfSquaresWide - 1;\n  } else {\n    colNumber = colNumber - 1;\n  }\n\n  const rowNumber = Math.ceil(squareToMoveTo / numberOfSquaresHigh) - 1;\n\n  document.querySelector(`.${pieceDOMElement}`).style.top = `calc(${\n    rowNumber * 100\n  }% / ${numberOfSquaresHigh})`;\n  document.querySelector(`.${pieceDOMElement}`).style.left = `calc(${\n    colNumber * 100\n  }% / ${numberOfSquaresWide})`;\n}\n\nexport function playHitAnimationUi(boardPosition) {\n  const element = document.querySelector(\n    `.${BOARD_SQUARE_CSS_CLASS_NAME}${boardPosition}`\n  );\n  element.classList.add(\"is-hit-animation\");\n  setTimeout(function () {\n    element.classList.remove(\"is-hit-animation\");\n  }, 2000);\n}\n\nexport function raiseBoardPositionUi(\n  boardPosition,\n  boardSquareCssClassName = BOARD_SQUARE_CSS_CLASS_NAME\n) {\n  document\n    .querySelector(`.${boardSquareCssClassName}${boardPosition}`)\n    .classList.add(\"is-raised\");\n}\n\nexport function raisePieceUi(playerId) {\n  document\n    .querySelector(`.${PIECE_CSS_CLASS_FOR_JS}${playerId}`)\n    .classList.add(\"is-raised\");\n}\n\nfunction removeActionsFromBoard() {\n  document\n    .querySelectorAll(`.${CSS_CLASS_NAME_FOR_ACTION}`)\n    .forEach((el) =>\n      el.classList.remove(\"cm-action\", \"js-action\", `cm-action--${ACTION_EXIT}`)\n    );\n}\n\nexport function removePieceFromBoardUi(pieceId) {\n  document.querySelector(`.${PIECE_CSS_CLASS_FOR_JS}${pieceId}`).remove();\n}\n\nfunction removePiecesFromBoard() {\n  document.querySelectorAll(`.${PIECE_CSS_CLASS_FOR_JS_BASE}`).forEach((el) => {\n    el.remove();\n  });\n}\n\nexport function setBoardPositionMissingUi(\n  boardPosition,\n  boardSquareCssClassName = BOARD_SQUARE_CSS_CLASS_NAME\n) {\n  document\n    .querySelector(`.${boardSquareCssClassName}${boardPosition}`)\n    .classList.add(\"is-missing\");\n}\n\nexport function setTargetBoardPositionsUi(boardPositions) {\n  boardPositions.forEach((position) => {\n    document\n      .querySelector(`.${BOARD_SQUARE_CSS_CLASS_NAME}${position}`)\n      .classList.add(\"is-target\");\n  });\n}\n\nexport function setPieceDidFallUi(piece) {\n  const el = document.querySelector(\n    `.${PIECE_CSS_CLASS_FOR_JS}${piece.playerId}`\n  );\n\n  if (el) {\n    el.classList.add(\"did-fall\");\n  }\n}\n\nexport function showMessageUi(message) {\n  document.querySelector(`.${CSS_CLASS_NAME_MESSAGE}`).innerHTML = message;\n}\n\nexport function updatePieceDirectionUi(piece) {\n  const cssClassName = generatePieceClassName(piece);\n\n  document.querySelector(\n    `.${PIECE_CSS_CLASS_FOR_JS}${piece.playerId}`\n  ).className = cssClassName;\n}\n\nexport function updatePlayerLivesUi(numberOfLives) {\n  const playerLivesDomContainer = document.querySelector(\".js-lives-counter\");\n  if (playerLivesDomContainer) {\n    playerLivesDomContainer.innerHTML = numberOfLives;\n  }\n}\n\nexport function togglePieceWeaponUi({ piece, weaponType }) {\n  const pieceDom = document.querySelector(\n    `.${PIECE_CSS_CLASS_FOR_JS}${piece.playerId}`\n  );\n  if (pieceDom) {\n    pieceDom.classList.toggle(`has-${weaponType}`);\n  }\n}\n","export const ACTION_EXIT = \"exit\";\nexport const ACTION_EXIT_CLOSED = \"exit--closed\";\nexport const ACTION_KEY = \"key\";\nexport const ACTION_LEVER_OFF = \"lever-off\";\nexport const ACTION_LEVER_ON = \"lever-on\";\nexport const ACTION_STAIRS = \"stairs\";\nexport const ACTION_SWORD = \"sword\";\nexport const ACTION_SHIELD = \"shield\";\nexport const ACTIONS_ALLOWED_FOR_AI = [ACTION_LEVER_OFF, ACTION_LEVER_ON];\nimport {\n  MESSAGE_KEY_PICK_UP,\n  MESSAGE_DOOR_LOCKED,\n  MESSAGE_SHIELD_PICK_UP,\n  MESSAGE_SWORD_PICK_UP,\n} from \"./dictionary\";\n\nimport { addActionToUi, clearActionUi, showMessageUi } from \"./ui\";\n\nexport function handleActionKey({ action, indexOfAction, levelActions }) {\n  // avoid mutation so create new array\n  const newLevelActions = JSON.parse(JSON.stringify(levelActions));\n  // remove the key action\n  clearActionUi(ACTION_KEY, action.boardPosition);\n  showMessageUi(MESSAGE_KEY_PICK_UP);\n  newLevelActions.splice(indexOfAction, 1);\n\n  // remove closed exit and replace with open exit\n  const actionExitClosedIndex = newLevelActions.findIndex(\n    (action) => action.type === ACTION_EXIT_CLOSED\n  );\n  if (actionExitClosedIndex > -1) {\n    newLevelActions[actionExitClosedIndex].type = ACTION_EXIT;\n    clearActionUi(\n      ACTION_EXIT_CLOSED,\n      newLevelActions[actionExitClosedIndex].boardPosition\n    );\n    const actionExitOpenIndex = actionExitClosedIndex;\n    addActionToUi(newLevelActions[actionExitOpenIndex]);\n  }\n\n  return newLevelActions;\n}\n\nexport function handleExitClosed() {\n  showMessageUi(MESSAGE_DOOR_LOCKED);\n}\n\nexport function handleActionLeverOff({ indexOfLeverOff, levelActions }) {\n  // avoid mutation so create new array\n  const newLevelActions = JSON.parse(JSON.stringify(levelActions));\n  showMessageUi(\"Let's pull this lever on!\");\n  newLevelActions[indexOfLeverOff].type = ACTION_LEVER_ON;\n  clearActionUi(\n    ACTION_LEVER_OFF,\n    newLevelActions[indexOfLeverOff].boardPosition\n  );\n  const indexOfLeverOn = indexOfLeverOff;\n  addActionToUi(newLevelActions[indexOfLeverOn]);\n\n  return newLevelActions;\n}\n\nexport function handleActionLeverOn({ indexOfLeverOn, levelActions }) {\n  // avoid mutation so create new array\n  const newLevelActions = JSON.parse(JSON.stringify(levelActions));\n  showMessageUi(\"Let's pull this lever off!\");\n  newLevelActions[indexOfLeverOn].type = ACTION_LEVER_OFF;\n  clearActionUi(ACTION_LEVER_ON, newLevelActions[indexOfLeverOn].boardPosition);\n  const indexOfLeverOff = indexOfLeverOn;\n  addActionToUi(newLevelActions[indexOfLeverOff]);\n\n  return newLevelActions;\n}\n\nexport function handleActionSword({ action, indexOfAction, levelActions }) {\n  // avoid mutation so create new array\n  const newLevelActions = JSON.parse(JSON.stringify(levelActions));\n  // remove the key action\n  clearActionUi(ACTION_SWORD, action.boardPosition);\n  showMessageUi(MESSAGE_SWORD_PICK_UP);\n  newLevelActions.splice(indexOfAction, 1);\n\n  return newLevelActions;\n}\n\nexport function handleActionShield({ action, indexOfAction, levelActions }) {\n  // avoid mutation so create new array\n  const newLevelActions = JSON.parse(JSON.stringify(levelActions));\n  // remove the key action\n  clearActionUi(ACTION_SHIELD, action.boardPosition);\n  showMessageUi(MESSAGE_SHIELD_PICK_UP);\n  newLevelActions.splice(indexOfAction, 1);\n\n  return newLevelActions;\n}\n","export const KEYCODE_UP = \"ArrowUp\";\nexport const KEYCODE_DOWN = \"ArrowDown\";\nexport const KEYCODE_LEFT = \"ArrowLeft\";\nexport const KEYCODE_RIGHT = \"ArrowRight\";\nexport const KEYCODE_UP_LEFT = \"KeyQ\";\nexport const KEYCODE_UP_RIGHT = \"KeyP\";\nexport const KEYCODE_DOWN_LEFT = \"KeyZ\";\nexport const KEYCODE_DOWN_RIGHT = \"KeyM\";\nexport const KEYCODE_RESTART = \"KeyR\";\nconst KEYCODE_ENTER = \"Enter\";\nexport const ALL_DIRECTIONS = [\n  KEYCODE_UP,\n  KEYCODE_DOWN,\n  KEYCODE_LEFT,\n  KEYCODE_RIGHT,\n  KEYCODE_UP_LEFT,\n  KEYCODE_UP_RIGHT,\n  KEYCODE_DOWN_LEFT,\n  KEYCODE_DOWN_RIGHT,\n];\n\nexport function initUserControls(\n  handleUserInputMove,\n  showNextMessage,\n  restartLevel\n) {\n  window.addEventListener(\"keyup\", (e) => {\n    if (\n      ![\n        KEYCODE_UP,\n        KEYCODE_DOWN,\n        KEYCODE_LEFT,\n        KEYCODE_RIGHT,\n        KEYCODE_UP_LEFT,\n        KEYCODE_UP_RIGHT,\n        KEYCODE_DOWN_LEFT,\n        KEYCODE_DOWN_RIGHT,\n        KEYCODE_ENTER,\n        KEYCODE_RESTART,\n      ].includes(e.code)\n    ) {\n      return;\n    }\n\n    switch (e.code) {\n      case KEYCODE_ENTER:\n        showNextMessage();\n        break;\n      case KEYCODE_RESTART:\n        restartLevel();\n        break;\n      default:\n        handleUserInputMove(e.code);\n        break;\n    }\n  });\n}\n","import {\n  KEYCODE_UP,\n  KEYCODE_DOWN,\n  KEYCODE_LEFT,\n  KEYCODE_RIGHT,\n  KEYCODE_UP_LEFT,\n  KEYCODE_UP_RIGHT,\n  KEYCODE_DOWN_RIGHT,\n  KEYCODE_DOWN_LEFT,\n} from \"./keyboard\";\nimport {\n  MESSAGE_SHOVED_AI_SHIELD,\n  MESSAGE_SQUASHED_AI_SHIELD,\n} from \"./dictionary\";\n\nimport {\n  getPieceCssClassName,\n  movePiece,\n  removePieceFromBoardUi,\n  setTargetBoardPositionsUi,\n  showMessageUi,\n} from \"./ui\";\n\nexport function canMoveLeft(currentBoardPosition, boardSizeX) {\n  if (currentBoardPosition && boardSizeX) {\n    return (currentBoardPosition - 1) % boardSizeX !== 0;\n  } else {\n    return false;\n  }\n}\n\nexport function canMoveRight(currentBoardPosition, boardSizeX) {\n  if (currentBoardPosition && boardSizeX) {\n    return (currentBoardPosition + 1) % boardSizeX !== 1;\n  } else {\n    return false;\n  }\n}\n\nexport function canMoveUp(currentBoardPosition, boardSizeY) {\n  if (currentBoardPosition && boardSizeY) {\n    return currentBoardPosition - boardSizeY > 0;\n  } else {\n    return false;\n  }\n}\n\nexport function canMoveDown(currentBoardPosition, boardSizeX, boardSizeY) {\n  if (currentBoardPosition && boardSizeY && boardSizeX) {\n    return currentBoardPosition + boardSizeY <= boardSizeX * boardSizeY;\n  } else {\n    return false;\n  }\n}\n\nexport const getNextBoardPositionWithDirection = {\n  [KEYCODE_UP]: function ({ currentBoardPosition, boardSizeY }) {\n    return canMoveUp(currentBoardPosition, boardSizeY)\n      ? currentBoardPosition - boardSizeY\n      : -1;\n  },\n  [KEYCODE_DOWN]: function ({ currentBoardPosition, boardSizeX, boardSizeY }) {\n    return canMoveDown(currentBoardPosition, boardSizeX, boardSizeY)\n      ? currentBoardPosition + boardSizeY\n      : -1;\n  },\n  [KEYCODE_LEFT]: function ({ currentBoardPosition, boardSizeX }) {\n    return !canMoveLeft(currentBoardPosition, boardSizeX)\n      ? -1\n      : currentBoardPosition - 1;\n  },\n  [KEYCODE_RIGHT]: function ({ currentBoardPosition, boardSizeX }) {\n    return !canMoveRight(currentBoardPosition, boardSizeX)\n      ? -1\n      : currentBoardPosition + 1;\n  },\n  [KEYCODE_UP_LEFT]: function ({\n    currentBoardPosition,\n    boardSizeX,\n    boardSizeY,\n  }) {\n    return canMoveLeft(currentBoardPosition, boardSizeX) &&\n      canMoveUp(currentBoardPosition, boardSizeY)\n      ? currentBoardPosition - 1 - boardSizeX\n      : -1;\n  },\n  [KEYCODE_DOWN_LEFT]: function ({\n    currentBoardPosition,\n    boardSizeX,\n    boardSizeY,\n  }) {\n    return canMoveLeft(currentBoardPosition, boardSizeX) &&\n      canMoveDown(currentBoardPosition, boardSizeX, boardSizeY)\n      ? currentBoardPosition - 1 + boardSizeX\n      : -1;\n  },\n  [KEYCODE_UP_RIGHT]: function ({\n    currentBoardPosition,\n    boardSizeX,\n    boardSizeY,\n  }) {\n    return canMoveRight(currentBoardPosition, boardSizeX) &&\n      canMoveUp(currentBoardPosition, boardSizeY)\n      ? currentBoardPosition + 1 - boardSizeX\n      : -1;\n  },\n  [KEYCODE_DOWN_RIGHT]: function ({\n    currentBoardPosition,\n    boardSizeX,\n    boardSizeY,\n  }) {\n    return canMoveRight(currentBoardPosition, boardSizeX) &&\n      canMoveDown(currentBoardPosition, boardSizeX, boardSizeY)\n      ? currentBoardPosition + 1 + boardSizeX\n      : -1;\n  },\n};\n\nexport function getAllBoardCheckPositions({\n  aiPieces = [],\n  boardPositionsOccupied = [],\n  boardSizeX,\n  boardSizeY,\n  currentBoardPositionsRaised = [],\n  showTargetLines,\n}) {\n  let allTargetBoardPositions = [];\n  aiPieces.forEach((piece) => {\n    const isPieceRaised = getIsPieceRaised({\n      piece,\n      boardPositionsRaised: currentBoardPositionsRaised,\n    });\n\n    if (isPieceRaised) {\n      return; // a raised piece has no check targets\n    } else {\n      const pieceTargetBoardPositions = getTargetLines({\n        piece,\n        boardPositionsOccupied,\n        boardSizeX: boardSizeX,\n        boardSizeY: boardSizeY,\n      });\n      if (showTargetLines) {\n        setTargetBoardPositionsUi(pieceTargetBoardPositions);\n      }\n      allTargetBoardPositions = allTargetBoardPositions.concat(\n        pieceTargetBoardPositions\n      );\n    }\n  });\n\n  return allTargetBoardPositions;\n}\n\n// returns board position to move to or -1 if invalud\nexport function getNextBoardPosition({\n  boardPositionsUnavailable = [],\n  boardSizeX,\n  boardSizeY,\n  currentBoardPosition,\n  direction,\n}) {\n  const moveToSquare = getNextBoardPositionWithDirection[direction]({\n    currentBoardPosition,\n    boardSizeX,\n    boardSizeY,\n  });\n\n  return isBoardPositionUnavailable(boardPositionsUnavailable, moveToSquare)\n    ? -1\n    : moveToSquare;\n}\n\nexport function getBoardPositionsUnavailable({\n  boardPositionsRaised = [],\n  boardPositionsMissing = [],\n}) {\n  // merge and remove duplicates\n  return [...new Set([...boardPositionsRaised, ...boardPositionsMissing])];\n}\n\nexport function getBoardPositionsAPieceCantBeShovedOnto({\n  aiPieces = [],\n  humanPieces = [],\n  boardPositionsRaised = [],\n}) {\n  const positionsOccupiedAi = aiPieces.map((piece) => piece.boardPosition);\n  const positionsOccupiedHumans = humanPieces.map(\n    (piece) => piece.boardPosition\n  );\n  // merge and remove duplicates\n  return [\n    ...new Set([\n      ...boardPositionsRaised,\n      ...positionsOccupiedAi,\n      ...positionsOccupiedHumans,\n    ]),\n  ];\n}\n\nexport function getBoardPositionsOccupied({\n  aiPieces = [],\n  boardPositionsRaised = [],\n  boardPositionsMissing = [],\n}) {\n  const positionsOccupiedAi = aiPieces.map((piece) => piece.boardPosition);\n  // merge and remove duplicates\n  return [\n    ...new Set([\n      ...positionsOccupiedAi,\n      ...boardPositionsRaised,\n      ...boardPositionsMissing,\n    ]),\n  ];\n}\n\nexport function getIsPieceRaised({ piece, boardPositionsRaised }) {\n  return (\n    boardPositionsRaised && boardPositionsRaised.includes(piece.boardPosition)\n  );\n}\n\nexport function getRandomBoardPosition({ boardSizeX, boardSizeY }) {\n  return Math.ceil(Math.random() * boardSizeX * boardSizeY);\n}\n\n// TODO improve return so there's no mutation of pieceTargetBoardPositions\nexport function getTargetLines({\n  piece,\n  boardPositionsOccupied = [],\n  boardSizeX,\n  boardSizeY,\n}) {\n  let pieceTargetBoardPositions = [];\n\n  piece.type.directions.forEach((direction) => {\n    const directionTargets = getTargetsWithDirection({\n      boardPositionsOccupied,\n      boardSizeX,\n      boardSizeY,\n      direction,\n      piece,\n    });\n    pieceTargetBoardPositions = pieceTargetBoardPositions.concat(\n      directionTargets\n    );\n  });\n\n  return pieceTargetBoardPositions;\n}\n\nfunction getTargetsWithDirection({\n  boardPositionsOccupied,\n  boardSizeX,\n  boardSizeY,\n  direction,\n  piece,\n}) {\n  let targets = [];\n  let currentBoardPosition = piece.boardPosition;\n  let loopCounter = 0; // so we don't get a recursive err if moveToSquare isn't working\n\n  function getNextTarget() {\n    const nextTargetSquare = getNextBoardPosition({\n      boardPositionsUnavailable: boardPositionsOccupied,\n      boardSizeX,\n      boardSizeY,\n      currentBoardPosition,\n      direction,\n    });\n    if (nextTargetSquare !== -1 && loopCounter < 50) {\n      targets.push(nextTargetSquare);\n      currentBoardPosition = nextTargetSquare;\n      if (!boardPositionsOccupied.includes(nextTargetSquare)) {\n        loopCounter++;\n        getNextTarget();\n      }\n    }\n  }\n\n  getNextTarget();\n\n  return targets;\n}\n\nexport function handleShovePiece({\n  piece,\n  directionOfShove,\n  boardPositionsUnavailable,\n  boardSizeX,\n  boardSizeY,\n}) {\n  const positionToShoveTo = getNextBoardPosition({\n    boardPositionsUnavailable,\n    boardSizeX,\n    boardSizeY,\n    currentBoardPosition: piece.boardPosition,\n    direction: directionOfShove,\n  });\n  if (positionToShoveTo === -1) {\n    removePieceFromBoardUi(piece.playerId);\n    showMessageUi(MESSAGE_SQUASHED_AI_SHIELD);\n    return null;\n  } else {\n    const pieceDomClassName = getPieceCssClassName(piece.playerId);\n    piece.boardPosition = positionToShoveTo;\n    showMessageUi(MESSAGE_SHOVED_AI_SHIELD);\n    movePiece(pieceDomClassName, positionToShoveTo, boardSizeX, boardSizeY);\n    return piece;\n  }\n}\n\nfunction isBoardPositionUnavailable(boardPositionsUnavailable, boardPosition) {\n  return (\n    boardPositionsUnavailable &&\n    boardPositionsUnavailable.length &&\n    boardPositionsUnavailable.includes(boardPosition)\n  );\n}\n","export function capitalize(string) {\n  if (typeof string !== \"string\") return \"\";\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\n","import {\n  KEYCODE_UP,\n  KEYCODE_DOWN,\n  KEYCODE_LEFT,\n  KEYCODE_RIGHT,\n  KEYCODE_UP_LEFT,\n  KEYCODE_UP_RIGHT,\n  KEYCODE_DOWN_RIGHT,\n  KEYCODE_DOWN_LEFT,\n  ALL_DIRECTIONS,\n} from \"./keyboard\";\nimport { togglePieceWeaponUi } from \"./ui\";\nimport { capitalize } from \"./utils\";\n\nclass Piece {\n  getRandomDirection() {\n    return this.directions[Math.floor(Math.random() * this.directions.length)];\n  }\n}\n\nexport class Queen extends Piece {\n  constructor() {\n    super();\n    this.directions = ALL_DIRECTIONS;\n    this.name = \"queen\";\n  }\n}\nexport class King extends Piece {\n  constructor() {\n    super();\n    this.directions = ALL_DIRECTIONS;\n    this.name = \"king\";\n  }\n}\nexport class Rook extends Piece {\n  constructor() {\n    super();\n    this.directions = [KEYCODE_UP, KEYCODE_DOWN, KEYCODE_LEFT, KEYCODE_RIGHT];\n    this.name = \"rook\";\n  }\n}\nexport class Bishop extends Piece {\n  constructor() {\n    super();\n    this.directions = [\n      KEYCODE_UP_LEFT,\n      KEYCODE_UP_RIGHT,\n      KEYCODE_DOWN_RIGHT,\n      KEYCODE_DOWN_LEFT,\n    ];\n    this.name = \"bishop\";\n  }\n}\n\nexport function getOppositeDirection(direction) {\n  switch (direction) {\n    case KEYCODE_UP:\n      return KEYCODE_DOWN;\n    case KEYCODE_DOWN:\n      return KEYCODE_UP;\n    case KEYCODE_LEFT:\n      return KEYCODE_RIGHT;\n    case KEYCODE_RIGHT:\n      return KEYCODE_LEFT;\n    case KEYCODE_UP_LEFT:\n      return KEYCODE_DOWN_RIGHT;\n    case KEYCODE_UP_RIGHT:\n      return KEYCODE_DOWN_LEFT;\n    case KEYCODE_DOWN_LEFT:\n      return KEYCODE_UP_RIGHT;\n    case KEYCODE_DOWN_RIGHT:\n      return KEYCODE_UP_LEFT;\n  }\n\n  return direction;\n}\n\nexport function togglePieceWeapon({ piece, hasWeapon, weaponType }) {\n  togglePieceWeaponUi({\n    piece,\n    weaponType,\n  });\n  const weaponTypeCapitalized = capitalize(weaponType);\n  piece[`has${weaponTypeCapitalized}`] = hasWeapon;\n\n  return piece;\n}\n","import { Bishop, King, Queen, Rook } from \"./piece\";\nimport {\n  KEYCODE_UP,\n  KEYCODE_DOWN,\n  KEYCODE_LEFT,\n  KEYCODE_RIGHT,\n  KEYCODE_UP_LEFT,\n  KEYCODE_UP_RIGHT,\n  KEYCODE_DOWN_LEFT,\n  KEYCODE_DOWN_RIGHT,\n} from \"./keyboard\";\nimport {\n  ACTION_EXIT,\n  ACTION_EXIT_CLOSED,\n  ACTION_KEY,\n  ACTION_LEVER_ON,\n  ACTION_STAIRS,\n  ACTION_SHIELD,\n  ACTION_SWORD,\n  ACTION_LEVER_OFF,\n} from \"./actions\";\n\nconst levels = [\n  {\n    actions: [\n      {\n        boardPosition: 9,\n        type: ACTION_EXIT,\n      },\n    ],\n    boardSize: {\n      boardSizeX: 3,\n      boardSizeY: 3,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 1,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"W..What!? Good God, it cannot be... The door of my cell... it's been left ajar! Someone must be trying to help me escape, but who?! ...[PRESS ENTER]\",\n      \"I've been locked in this cell for so long now I feel like I've forgotten how to move! ... If I remember correctly, use the keyboard direction arrows to move me around. Now let's try and escape this damp and lonely cell!\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 16,\n        type: ACTION_EXIT,\n      },\n    ],\n    boardPositionsRaised: [5, 6, 7, 9, 10, 11, 13, 14, 15],\n    boardSize: {\n      boardSizeX: 4,\n      boardSizeY: 4,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 1,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Mmm... there's only one way to go, down this corridor. Tread carefully now, there may be guards about...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 24,\n        type: ACTION_EXIT,\n      },\n      {\n        boardPosition: 2,\n        type: ACTION_EXIT_CLOSED,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 22,\n        direction: KEYCODE_UP,\n      },\n    ],\n    boardPositionsRaised: [\n      1,\n      3,\n      5,\n      6,\n      8,\n      10,\n      11,\n      13,\n      15,\n      16,\n      18,\n      20,\n      21,\n      23,\n      25,\n    ],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 4,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"What's that?! On the other side of this wall... I hear footsteps!<br />I must move quietly; if I'm caught I'll be sent straight back to my cell, or worse...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 16,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 11,\n        type: ACTION_KEY,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Bishop(),\n        playerId: \"ai-1\",\n        boardPosition: 3,\n        direction: KEYCODE_DOWN_RIGHT,\n      },\n    ],\n    boardPositionsRaised: [2, 6, 10],\n    boardSize: {\n      boardSizeX: 4,\n      boardSizeY: 4,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 1,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Is that?... I think I can hear one of the castle bishops praying. They sometimes visit me in my cell, offering me forgiveness for my sins, hah!<br />Now I know bishops can only move and see diagonally, but still, I'll have to tread carefully here...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 3,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 7,\n        type: ACTION_KEY,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Bishop(),\n        playerId: \"ai-1\",\n        boardPosition: 4,\n        direction: KEYCODE_UP_RIGHT,\n      },\n    ],\n    boardPositionsRaised: [8],\n    boardSize: {\n      boardSizeX: 3,\n      boardSizeY: 3,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 1,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Gasp! A bishop, right in front of me!<br />He'll move in diagonals, trying to catch me!<br />Well luckily, I can move in diagonals too, using M, Z, Q, or P, on the keyboard. Let's slip by him and escape!\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 12,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 2,\n        type: ACTION_KEY,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Bishop(),\n        playerId: \"ai-1\",\n        boardPosition: 8,\n        direction: KEYCODE_UP_LEFT,\n      },\n    ],\n    boardPositionsRaised: [1, 5, 11, 14, 15, 16],\n    boardSize: {\n      boardSizeX: 4,\n      boardSizeY: 4,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 13,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Phewf, that was close. But, another bishop! Goodness, they must have just finished in the chapel.<br />I need to stay out of his line of sight. Luckily I can slip past walls diagonally to try and evade him...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 13,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 3,\n        type: ACTION_KEY,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 8,\n        direction: KEYCODE_DOWN,\n      },\n    ],\n    boardPositionsRaised: [],\n    boardSize: {\n      boardSizeX: 4,\n      boardSizeY: 4,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 1,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"No! Out of the frying pan and into the fire! It's a rook, one of the castle guards on his rounds!<br />I've heard that when they patrol, they only move and see up or down, or left of right. Quickly, run for that door!\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 21,\n        type: ACTION_EXIT,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Bishop(),\n        playerId: \"ai-1\",\n        boardPosition: 9,\n        direction: KEYCODE_UP_LEFT,\n      },\n      {\n        type: new Rook(),\n        playerId: \"ai-2\",\n        boardPosition: 5,\n        direction: KEYCODE_DOWN,\n      },\n    ],\n    boardPositionsRaised: [2, 7, 12, 22],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 1,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Movement again to my left. I'll have to stay out of sight of that opening. Hopefully I can slip out through that door before anyone sees me...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 3,\n        type: ACTION_EXIT,\n      },\n    ],\n    boardPositionsMissing: [],\n    boardPositionsRaised: [6, 7, 10, 11],\n    boardSize: {\n      boardSizeX: 4,\n      boardSizeY: 4,\n    },\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 8,\n        direction: KEYCODE_DOWN,\n      },\n    ],\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 15,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"There are more prison cells in these corridors... Urgh, I wonder how many of my men they have locked away down here...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 25,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 22,\n        type: ACTION_KEY,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Bishop(),\n        playerId: \"ai-1\",\n        boardPosition: 12,\n        direction: KEYCODE_DOWN_LEFT,\n      },\n    ],\n    boardPositionsRaised: [4, 9, 19, 24],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 5,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"I smell incense and the clinking of prayer beads. That can mean only one thing, a bishop!\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 16,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 2,\n        type: ACTION_KEY,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 14,\n        direction: KEYCODE_UP,\n      },\n      {\n        type: new Bishop(),\n        playerId: \"ai-2\",\n        boardPosition: 10,\n        direction: KEYCODE_UP_LEFT,\n      },\n    ],\n    boardPositionsRaised: [7],\n    boardSize: {\n      boardSizeX: 4,\n      boardSizeY: 4,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 3,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\"Guards, everywhere! I'll have to watch my step here...\"],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 17,\n        type: ACTION_EXIT,\n        iconSpecific: ACTION_STAIRS,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 19,\n        direction: KEYCODE_UP,\n      },\n    ],\n    boardPositionsMissing: [1, 5, 21, 25],\n    boardPositionsRaised: [2, 4, 6, 10, 11, 13, 15, 16, 20, 22, 23, 24],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 3,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Ah, a tower... Maybe if I can get up high I can see the lay of the land and a way out!\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 6,\n        type: ACTION_EXIT,\n        iconSpecific: ACTION_STAIRS,\n      },\n    ],\n    boardPositionsMissing: [1, 4, 13, 16],\n    boardPositionsRaised: [2, 3, 5, 8, 9, 12, 14, 15],\n    boardSize: {\n      boardSizeX: 4,\n      boardSizeY: 4,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 11,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"It's breezy and cool up here, I must be near the top now...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 6,\n        type: ACTION_EXIT,\n        iconSpecific: ACTION_STAIRS,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Bishop(),\n        playerId: \"ai-1\",\n        boardPosition: 8,\n        direction: KEYCODE_DOWN_RIGHT,\n      },\n      {\n        type: new Bishop(),\n        playerId: \"ai-2\",\n        boardPosition: 12,\n        direction: KEYCODE_UP_RIGHT,\n      },\n    ],\n    boardPositionsRaised: [1, 3, 5, 17, 19],\n    boardPositionsMissing: [2, 4, 16, 18, 20, 21, 22, 23, 24, 25],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 10,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Ah, the sun, the wind! I may be in for a tustle here, the ramparts are well guarded...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 9,\n        type: ACTION_SWORD,\n      },\n      {\n        boardPosition: 11,\n        type: ACTION_EXIT,\n        iconSpecific: ACTION_STAIRS,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 7,\n        direction: KEYCODE_DOWN,\n      },\n    ],\n    boardPositionsMissing: [1, 5, 21, 25],\n    boardPositionsRaised: [2, 3, 4, 6, 10, 16, 20, 22, 23, 24],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 15,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Damn, they're guarding the doors. I'll have to try and take him out...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 6,\n        type: ACTION_EXIT,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 16,\n        direction: KEYCODE_DOWN,\n      },\n      {\n        type: new Bishop(),\n        playerId: \"ai-2\",\n        boardPosition: 23,\n        direction: KEYCODE_UP_LEFT,\n      },\n    ],\n    boardPositionsMissing: [1, 2, 7, 25, 31, 32],\n    boardPositionsRaised: [3, 4, 8, 13, 18, 19, 24, 26, 33, 34],\n    boardSize: {\n      boardSizeX: 6,\n      boardSizeY: 6,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 20,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\"Guards, everywhere!\"],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 1,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 10,\n        type: ACTION_KEY,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 9,\n        direction: KEYCODE_RIGHT,\n      },\n      {\n        type: new Rook(),\n        playerId: \"ai-2\",\n        boardPosition: 8,\n        direction: KEYCODE_UP,\n      },\n      {\n        type: new Bishop(),\n        playerId: \"ai-3\",\n        boardPosition: 3,\n        direction: KEYCODE_DOWN_RIGHT,\n      },\n    ],\n    boardPositionsRaised: [18],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 21,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Hmm, I'm in a tricky spot here, I'll have to be deft with my movements!\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 25,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 5,\n        type: ACTION_EXIT,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 10,\n        direction: KEYCODE_DOWN,\n      },\n    ],\n    boardPositionsRaised: [],\n    boardPositionsMissing: [7, 8, 9, 12, 13, 14, 17, 18, 19],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 21,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"That was close...<br />Goodness, a deep drop into the dark, I can't see the bottom! There's a cool, damp updraft, making me feel unsteady at the edge. It looks like a well...<br />I'd best keep to the wall and watch my footing here...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 10,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 13,\n        type: ACTION_KEY,\n      },\n      {\n        boardPosition: 4,\n        type: ACTION_SWORD,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Bishop(),\n        playerId: \"ai-1\",\n        boardPosition: 10,\n        direction: KEYCODE_DOWN_LEFT,\n      },\n      {\n        type: new Bishop(),\n        playerId: \"ai-2\",\n        boardPosition: 17,\n        direction: KEYCODE_DOWN_LEFT,\n      },\n      {\n        type: new Rook(),\n        playerId: \"ai-3\",\n        boardPosition: 24,\n        direction: KEYCODE_LEFT,\n      },\n    ],\n    boardPositionsRaised: [1, 5, 21, 25],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 2,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"This stone warren is full of guards! I'm in for a fight here...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 5,\n        type: ACTION_EXIT,\n        iconSpecific: ACTION_STAIRS,\n      },\n      {\n        boardPosition: 24,\n        type: ACTION_SHIELD,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 13,\n        direction: KEYCODE_RIGHT,\n      },\n    ],\n    boardPositionsRaised: [1, 6],\n    boardPositionsMissing: [2, 3, 4, 7, 8, 9],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 21,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"I think we're underground, and it's heavily guarded... perhaps the word is out that my cell is empty!\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 1,\n        type: ACTION_EXIT,\n      },\n      {\n        boardPosition: 21,\n        type: ACTION_LEVER_ON,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 6,\n        direction: KEYCODE_LEFT,\n      },\n    ],\n    boardPositionsMissing: [],\n    boardPositionsRaised: [10, 20],\n    boardSize: {\n      boardSizeX: 5,\n      boardSizeY: 5,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 25,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"That was unpleasant, but not as unpleasant as what they'll do to me again if I'm caught!\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 4,\n        type: ACTION_EXIT,\n      },\n      {\n        boardPosition: 9,\n        type: ACTION_LEVER_ON,\n      },\n    ],\n    boardPositionsMissing: [],\n    boardPositionsRaised: [11, 15, 16],\n    boardSize: {\n      boardSizeX: 4,\n      boardSizeY: 4,\n    },\n    aiPieces: [\n      {\n        type: new Rook(),\n        playerId: \"ai-1\",\n        boardPosition: 12,\n        direction: KEYCODE_DOWN,\n      },\n      {\n        type: new Rook(),\n        playerId: \"ai-2\",\n        boardPosition: 7,\n        direction: KEYCODE_DOWN,\n      },\n    ],\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 14,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"What kind of lever and pulley system is this?! Moving walls and hidden spaces, my my... Well, if I can use them to my advantage...\",\n    ],\n  },\n  {\n    actions: [\n      {\n        boardPosition: 1,\n        type: ACTION_EXIT_CLOSED,\n      },\n      {\n        boardPosition: 7,\n        type: ACTION_KEY,\n      },\n    ],\n    aiPieces: [\n      {\n        type: new Queen(),\n        playerId: \"ai-1\",\n        boardPosition: 18,\n        direction: KEYCODE_DOWN_LEFT,\n      },\n    ],\n    boardPositionsMissing: [],\n    boardPositionsRaised: [8, 14, 22, 28, 37, 38, 39, 40, 42],\n    boardSize: {\n      boardSizeX: 7,\n      boardSizeY: 7,\n    },\n    humanPieces: [\n      {\n        type: new King(),\n        playerId: \"human-one\",\n        boardPosition: 46,\n        lives: 1,\n      },\n    ],\n    levelMessages: [\n      \"Is that... a Queen guard?! I wondered when we'd cross paths, and was hoping we wouldn't; Queens are the most agile of the guards and can move and see in all directions! Careful now...\",\n    ],\n  },\n];\n\n// export function getNumberOfLevels() {\n//   return levels.length;\n// }\n\nexport default levels;\n","import { clearLevelUi, showMessageUi } from \"./ui\";\nimport levels from \"./levels\";\n\nexport function loadLevel(levelNumber) {\n  return JSON.parse(JSON.stringify(levels[levelNumber]));\n}\n\nexport function clearLevel() {\n  clearLevelUi();\n  return {};\n}\n\nexport function showLevelMessage(levelMessages, messageIndex) {\n  if (levelMessages && levelMessages.length) {\n    if (messageIndex < levelMessages.length) {\n      showMessageUi(levelMessages[messageIndex]);\n    }\n  }\n}\n\nexport function getNumberOfLevels() {\n  return levels.length;\n}\n","import { getNextBoardPosition, getIsPieceRaised } from \"./board\";\nimport { getOppositeDirection } from \"./piece\";\nimport { getPieceCssClassName, movePiece, updatePieceDirectionUi } from \"./ui\";\n\nexport function moveAi({\n  aiPieces,\n  boardPositionsRaised,\n  boardPositionsUnavailable,\n  boardSizeX,\n  boardSizeY,\n}) {\n  return aiPieces.map((piece) => {\n    const isPieceRaised = getIsPieceRaised({ piece, boardPositionsRaised });\n\n    if (!isPieceRaised) {\n      // only move if piece is not on a raised position\n      const moveToSquare = getNextBoardPosition({\n        boardPositionsUnavailable,\n        boardSizeX,\n        boardSizeY,\n        currentBoardPosition: piece.boardPosition,\n        direction: piece.direction,\n      });\n\n      if (moveToSquare !== -1) {\n        piece.boardPosition = moveToSquare;\n        const pieceDomClass = getPieceCssClassName(piece.playerId);\n        movePiece(pieceDomClass, moveToSquare, boardSizeX, boardSizeY);\n      }\n    }\n\n    return piece;\n  });\n}\n\n// TODO there are instances when an ai will clash with another\n// this would be a good one to add a test for and then refactor!\nexport function getAiWithDirectionsForNextMove({\n  aiPieces,\n  boardPositionsRaised,\n  boardPositionsUnavailable,\n  boardSizeX,\n  boardSizeY,\n}) {\n  // store the next moves so you don't clash with a piece that's already moved\n  let nextMoves = [];\n  return aiPieces.map((piece) => {\n    const isPieceRaised = getIsPieceRaised({ piece, boardPositionsRaised });\n\n    if (!isPieceRaised) {\n      // only for if a piece isn't on a raised position\n      const nextMove = getNextBoardPosition({\n        boardPositionsUnavailable,\n        boardSizeX,\n        boardSizeY,\n        currentBoardPosition: piece.boardPosition,\n        direction: piece.direction,\n      });\n\n      // if next move is invalid or already taken, check opposite\n      if (nextMove === -1 || nextMoves.includes(nextMove)) {\n        piece.direction = getOppositeDirection(piece.direction);\n        updatePieceDirectionUi(piece);\n\n        // can it move in the other direction\n        const nextMoveOpposite = getNextBoardPosition({\n          boardPositionsUnavailable,\n          boardSizeX,\n          boardSizeY,\n          currentBoardPosition: piece.boardPosition,\n          direction: piece.direction,\n        });\n\n        if (nextMoveOpposite === -1 || nextMoves.includes(nextMoveOpposite)) {\n          console.log(\"it's stuck!\");\n        } else {\n          nextMoves.push(nextMoveOpposite);\n        }\n      } else {\n        nextMoves.push(nextMove);\n      }\n    }\n\n    return piece;\n  });\n}\n","import {\n  ACTIONS_ALLOWED_FOR_AI,\n  ACTION_EXIT,\n  ACTION_EXIT_CLOSED,\n  ACTION_KEY,\n  ACTION_LEVER_OFF,\n  ACTION_LEVER_ON,\n  ACTION_SWORD,\n  ACTION_SHIELD,\n  handleActionKey,\n  handleExitClosed,\n  handleActionLeverOff,\n  handleActionLeverOn,\n  handleActionSword,\n  handleActionShield,\n} from \"./actions\";\nimport {\n  getNextBoardPosition,\n  getBoardPositionsOccupied,\n  getBoardPositionsUnavailable,\n  getBoardPositionsAPieceCantBeShovedOnto,\n  getAllBoardCheckPositions,\n  handleShovePiece,\n} from \"./board\";\nimport {\n  MESSAGE_HUMAN_CHECK,\n  MESSAGE_HUMAN_TAKEN,\n  MESSAGE_KILLED_AI_SWORD,\n  MESSAGE_PIECE_FELL,\n} from \"./dictionary\";\nimport { initUserControls } from \"./keyboard\";\nimport { clearLevel, loadLevel, showLevelMessage } from \"./level\";\nimport { getAiWithDirectionsForNextMove, moveAi } from \"./ai\";\nimport {\n  PIECE_MOVE_ANIMATION_TIME_MS,\n  createBoardUi,\n  clearTargetBoardPositionsUi,\n  handleLoweringPiecesUi,\n  handleRaisingPiecesUi,\n  initActionsUi,\n  initAiPiecesUi,\n  initBoardPositionsMissingUi,\n  initBoardPositionsRaisedUi,\n  initHumanPiecesUi,\n  initLevelNumberUi,\n  initSettingsUi,\n  movePiece,\n  playHitAnimationUi,\n  removePieceFromBoardUi,\n  setPieceDidFallUi,\n  showMessageUi,\n} from \"./ui\";\nimport { togglePieceWeapon } from \"./piece\";\nimport { getNumberOfLevels } from \"./level\";\n\nconst gameState = {\n  levelState: {},\n  nextLevelNumber: 0,\n  showTargetLines: true,\n  init: function () {\n    initUserControls(\n      this.handleUserInputMove.bind(this),\n      this.showNextMessage.bind(this),\n      this.restartLevel.bind(this)\n    );\n    initSettingsUi(this.handleGoToLevel.bind(this));\n    this.initLevel();\n  },\n  initLevel: function () {\n    const numberOfLevels = getNumberOfLevels();\n    if (this.nextLevelNumber >= getNumberOfLevels()) {\n      alert(\n        \"This is the last level in the prototype, thanks for trying it out! Please leave your feedback in the footer link \"\n      );\n    } else {\n      clearLevel();\n      this.levelState.levelOver = false;\n      this.levelState = loadLevel(this.nextLevelNumber);\n      this.nextLevelNumber++;\n      this.initLevelMessages(this.levelState.levelMessages);\n      this.showNextMessage();\n      createBoardUi({\n        boardSizeX: this.levelState.boardSize.boardSizeX,\n        boardSizeY: this.levelState.boardSize.boardSizeY,\n      });\n      initHumanPiecesUi(\n        this.levelState.humanPieces,\n        this.levelState.boardSize.boardSizeX,\n        this.levelState.boardSize.boardSizeY\n      );\n      initAiPiecesUi(\n        this.levelState.aiPieces,\n        this.levelState.boardSize.boardSizeX,\n        this.levelState.boardSize.boardSizeY\n      );\n      initActionsUi(this.levelState.actions);\n      initBoardPositionsRaisedUi(this.levelState.boardPositionsRaised);\n      initBoardPositionsMissingUi(this.levelState.boardPositionsMissing);\n      initLevelNumberUi(this.nextLevelNumber, numberOfLevels);\n      this.levelState.currentBoardPositionsRaised = this.levelState.boardPositionsRaised;\n      this.endMove();\n    }\n  },\n  beforeMove: function () {\n    this.isMoving = true;\n    if (this.showTargetLines) {\n      clearTargetBoardPositionsUi();\n    }\n  },\n  checkActionsInterceptHuman: function () {\n    const indexOfLevelStateAction = this.levelState.actions.findIndex(\n      (action) => {\n        return (\n          action.boardPosition === this.levelState.humanPieces[0].boardPosition\n        );\n      }\n    );\n    if (indexOfLevelStateAction > -1) {\n      this.doBoardAction(indexOfLevelStateAction);\n    }\n  },\n  checkActionsInterceptAi: function () {\n    if (this.levelState.aiPieces && this.levelState.aiPieces.length) {\n      this.levelState.aiPieces.forEach((aiPiece) => {\n        const indexOfLevelStateAction = this.levelState.actions.findIndex(\n          (action) => {\n            return action.boardPosition === aiPiece.boardPosition;\n          }\n        );\n        if (indexOfLevelStateAction > -1) {\n          if (\n            ACTIONS_ALLOWED_FOR_AI.includes(\n              this.levelState.actions[indexOfLevelStateAction].type\n            )\n          ) {\n            this.doBoardAction(indexOfLevelStateAction);\n          }\n        }\n      });\n    }\n  },\n  checkHumanInCheck: function () {\n    if (this.levelState.aiPieces && this.levelState.aiPieces.length) {\n      const allCheckBoardPositions = getAllBoardCheckPositions({\n        aiPieces: this.levelState.aiPieces,\n        boardPositionsOccupied: this.levelState.boardPositionsOccupied,\n        boardSizeX: this.levelState.boardSize.boardSizeX,\n        boardSizeY: this.levelState.boardSize.boardSizeY,\n        currentBoardPositionsRaised: this.levelState\n          .currentBoardPositionsRaised,\n        showTargetLines: this.showTargetLines,\n      });\n\n      if (allCheckBoardPositions && allCheckBoardPositions.length) {\n        this.checkTargetLinesIntercept(allCheckBoardPositions);\n      }\n    }\n  },\n  checkHumanInterceptsAi: function () {\n    if (this.levelState.aiPieces && this.levelState.aiPieces.length) {\n      this.levelState.aiPieces = this.levelState.aiPieces.filter((ai) => {\n        const humanThatWasInterceptedIndex = this.levelState.humanPieces.findIndex(\n          (human) => {\n            return human.boardPosition === ai.boardPosition;\n          }\n        );\n        let humanThatWasIntercepted = this.levelState.humanPieces[\n          humanThatWasInterceptedIndex\n        ];\n        if (humanThatWasInterceptedIndex === -1) {\n          return true;\n        } else if (humanThatWasIntercepted.hasSword) {\n          removePieceFromBoardUi(ai.playerId);\n          showMessageUi(MESSAGE_KILLED_AI_SWORD);\n          humanThatWasIntercepted = togglePieceWeapon({\n            piece: humanThatWasIntercepted,\n            hasWeapon: false,\n            weaponType: ACTION_SWORD,\n          });\n          return false;\n        } else if (humanThatWasIntercepted.hasShield) {\n          // side effect - ai boardPosition updated\n          const unavailablePositions = getBoardPositionsAPieceCantBeShovedOnto({\n            aiPieces: this.levelState.aiPieces,\n            humanPieces: this.levelState.humanPieces,\n            boardPositionsRaised: this.levelState.currentBoardPositionsRaised,\n          });\n          ai = handleShovePiece({\n            piece: ai,\n            directionOfShove: humanThatWasIntercepted.lastUserInput,\n            boardPositionsUnavailable: unavailablePositions,\n            boardSizeX: this.levelState.boardSize.boardSizeX,\n            boardSizeY: this.levelState.boardSize.boardSizeY,\n          });\n          humanThatWasIntercepted = togglePieceWeapon({\n            piece: humanThatWasIntercepted,\n            hasWeapon: false,\n            weaponType: ACTION_SHIELD,\n          });\n          return !!ai;\n        } else {\n          removePieceFromBoardUi(humanThatWasIntercepted.playerId);\n          showMessageUi(MESSAGE_HUMAN_TAKEN);\n          this.levelState.levelOver = true;\n          return true;\n        }\n      });\n    }\n  },\n  checkMissingBoardPositionForHuman: function () {\n    if (\n      this.levelState.boardPositionsMissing &&\n      this.levelState.boardPositionsMissing.length &&\n      this.levelState.boardPositionsMissing.includes(\n        this.levelState.humanPieces[0].boardPosition\n      )\n    ) {\n      setPieceDidFallUi(this.levelState.humanPieces[0]);\n      this.levelState.levelOver = true;\n      showMessageUi(MESSAGE_PIECE_FELL);\n    }\n  },\n  checkMissingBoardPositionsForAi: function () {\n    if (\n      this.levelState.boardPositionsMissing &&\n      this.levelState.boardPositionsMissing.length &&\n      this.levelState.aiPieces &&\n      this.levelState.aiPieces.length\n    ) {\n      this.levelState.aiPieces = this.levelState.aiPieces.filter((ai) => {\n        if (this.levelState.boardPositionsMissing.includes(ai.boardPosition)) {\n          setPieceDidFallUi(ai);\n          return false;\n        } else {\n          return true;\n        }\n      });\n    }\n  },\n  checkTargetLinesIntercept: function (allCheckBoardPositions) {\n    if (\n      allCheckBoardPositions.includes(\n        this.levelState.humanPieces[0].boardPosition\n      )\n    ) {\n      playHitAnimationUi(this.levelState.humanPieces[0].boardPosition);\n      this.levelState.levelOver = true;\n      showMessageUi(MESSAGE_HUMAN_CHECK);\n    }\n  },\n  doBoardAction: function (indexOfLevelStateAction) {\n    const action = this.levelState.actions[indexOfLevelStateAction];\n    switch (action.type) {\n      case ACTION_EXIT:\n        setTimeout(() => {\n          this.initLevel(this.nextLevelNumber);\n        }, PIECE_MOVE_ANIMATION_TIME_MS);\n        break;\n      case ACTION_EXIT_CLOSED:\n        handleExitClosed();\n        break;\n      case ACTION_KEY:\n        this.levelState.actions = handleActionKey({\n          action,\n          indexOfAction: indexOfLevelStateAction,\n          levelActions: this.levelState.actions,\n        });\n        break;\n      case ACTION_LEVER_OFF:\n        this.levelState.actions = handleActionLeverOff({\n          indexOfLeverOff: indexOfLevelStateAction,\n          levelActions: this.levelState.actions,\n        });\n        initBoardPositionsRaisedUi(this.levelState.boardPositionsRaised);\n        this.levelState.currentBoardPositionsRaised = handleRaisingPiecesUi({\n          aiPieces: this.levelState.aiPieces,\n          boardPositionsRaised: this.levelState.boardPositionsRaised,\n          humanPieces: this.levelState.humanPieces,\n        });\n        break;\n      case ACTION_LEVER_ON:\n        this.levelState.actions = handleActionLeverOn({\n          indexOfLeverOn: indexOfLevelStateAction,\n          levelActions: this.levelState.actions,\n        });\n        this.levelState.currentBoardPositionsRaised = handleLoweringPiecesUi({\n          aiPieces: this.levelState.aiPieces,\n          boardPositionsRaised: this.levelState.boardPositionsRaised,\n          humanPieces: this.levelState.humanPieces,\n        });\n        break;\n      case ACTION_SWORD:\n        this.levelState.actions = handleActionSword({\n          action,\n          indexOfAction: indexOfLevelStateAction,\n          levelActions: this.levelState.actions,\n        });\n        this.levelState.humanPieces[0] = togglePieceWeapon({\n          piece: this.levelState.humanPieces[0],\n          hasWeapon: true,\n          weaponType: ACTION_SWORD,\n        });\n        break;\n      case ACTION_SHIELD:\n        this.levelState.actions = handleActionShield({\n          action,\n          indexOfAction: indexOfLevelStateAction,\n          levelActions: this.levelState.actions,\n        });\n        this.levelState.humanPieces[0] = togglePieceWeapon({\n          piece: this.levelState.humanPieces[0],\n          hasWeapon: true,\n          weaponType: ACTION_SHIELD,\n        });\n        break;\n    }\n  },\n  endMove: function () {\n    this.checkActionsInterceptHuman();\n    if (!this.levelState.levelOver) {\n      setTimeout(() => {\n        this.checkHumanInterceptsAi();\n        this.checkMissingBoardPositionForHuman();\n        this.checkMissingBoardPositionsForAi();\n        this.updateBoardPositionsUnavailable();\n        this.updateBoardPositionsOccupied();\n        this.checkActionsInterceptAi();\n        this.checkHumanInCheck();\n        this.updateAiDirections();\n        this.isMoving = false;\n      }, PIECE_MOVE_ANIMATION_TIME_MS);\n    }\n  },\n  handleMove: function (keyCode) {\n    const squareToMoveTo = getNextBoardPosition({\n      boardPositionsUnavailable: this.levelState.currentBoardPositionsRaised,\n      boardSizeX: this.levelState.boardSize.boardSizeX,\n      boardSizeY: this.levelState.boardSize.boardSizeY,\n      currentBoardPosition: this.levelState.humanPieces[0].boardPosition,\n      direction: keyCode,\n    });\n    if (squareToMoveTo === -1) {\n      return;\n    }\n\n    this.levelState.humanPieces[0].boardPosition = squareToMoveTo;\n    movePiece(\n      \"js-piece--human-one\",\n      squareToMoveTo,\n      this.levelState.boardSize.boardSizeX,\n      this.levelState.boardSize.boardSizeY\n    );\n\n    if (this.levelState.aiPieces && this.levelState.aiPieces.length) {\n      this.levelState.aiPieces = moveAi({\n        aiPieces: this.levelState.aiPieces,\n        boardPositionsUnavailable: this.levelState.boardPositionsUnavailable,\n        boardSizeX: this.levelState.boardSize.boardSizeX,\n        boardSizeY: this.levelState.boardSize.boardSizeY,\n      });\n    }\n  },\n  handleGoToLevel: function (levelIndex) {\n    // if go back a level\n    if (levelIndex === -1) {\n      // this.nextLevelNumber - 1 is the current level\n      const nextLevelIndex = this.nextLevelNumber - 2;\n      if (nextLevelIndex > -1) {\n        this.nextLevelNumber = nextLevelIndex;\n        this.initLevel();\n      } else {\n        alert(\"This is the first level, you can't go back any more :)\");\n      }\n    } else {\n      this.initLevel(); // default to next level\n    }\n  },\n  handleUserInputMove: function (keyCode) {\n    this.levelState.humanPieces[0].lastUserInput = keyCode;\n    if (!this.levelState.levelOver && !this.isMoving) {\n      this.beforeMove();\n      this.handleMove(keyCode);\n      this.endMove();\n    }\n  },\n  initLevelMessages: function (levelMessages) {\n    if (levelMessages) {\n      this.levelState.levelMessages = levelMessages;\n      this.levelState.messageIndex = 0;\n    }\n  },\n  restartLevel: function () {\n    this.nextLevelNumber--;\n    this.initLevel();\n  },\n  showNextMessage: function () {\n    showLevelMessage(\n      this.levelState.levelMessages,\n      this.levelState.messageIndex\n    );\n    this.levelState.messageIndex++;\n  },\n  updateAiDirections: function () {\n    if (this.levelState.aiPieces && this.levelState.aiPieces.length) {\n      this.levelState.aiPieces = getAiWithDirectionsForNextMove({\n        aiPieces: this.levelState.aiPieces,\n        boardPositionsRaised: this.levelState.currentBoardPositionsRaised,\n        boardPositionsUnavailable: this.levelState.boardPositionsUnavailable,\n        boardSizeX: this.levelState.boardSize.boardSizeX,\n        boardSizeY: this.levelState.boardSize.boardSizeY,\n      });\n    }\n  },\n  updateBoardPositionsOccupied: function () {\n    this.levelState.boardPositionsOccupied = getBoardPositionsOccupied({\n      aiPieces: this.levelState.aiPieces,\n      boardPositionsRaised: this.levelState.currentBoardPositionsRaised,\n      boardPositionsMissing: this.levelState.boardPositionsMissing,\n    });\n  },\n  updateBoardPositionsUnavailable: function () {\n    this.levelState.boardPositionsUnavailable = getBoardPositionsUnavailable({\n      boardPositionsRaised: this.levelState.currentBoardPositionsRaised,\n      boardPositionsMissing: this.levelState.boardPositionsMissing,\n    });\n  },\n  updatePlayerLives: function (increment) {\n    this.levelState.humanPieces[0].lives =\n      this.levelState.humanPieces[0].lives + increment;\n  },\n};\n\nexport default gameState;\n","import gameState from \"./gameState\";\n\nfunction init() {\n  gameState.init();\n}\n\nwindow.onload = function () {\n  init();\n};\n"]}